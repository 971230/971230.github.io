---
title: è§‚å¯Ÿè€…æ¨¡å¼
description: è§‚å¯Ÿè€…æ¨¡å¼
# status: new
---

# è§‚å¯Ÿè€…æ¨¡å¼

![å›¾ç‰‡çš„æ ·å¼](./img/observer-2x.png)

!!! Warning ""
    è¿™ä¸ªæ¨¡å¼è‡ªå·±æ²¡æœ‰å®é™…ä½¿ç”¨è¿‡ï¼Œæ„Ÿè§‰å¯¹å®ƒçš„ç†è§£æœ‰ç‚¹é—®é¢˜ï¼Œæœ‰æœºä¼šå†ææ¸…æ¥šäº›ã€‚

<P style="text-indent:2em;">
è§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒè®¢é˜…æ¨¡å¼å¾ˆåƒã€‚
é€‚ç”¨äºå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å˜åŒ–éœ€è¦é€šçŸ¥å¤šä¸ªå…¶ä»–å¯¹è±¡æ—¶å’Œäº‹ä»¶é©±åŠ¨ç³»ç»Ÿé‡Œé¢ï¼Œæ¶ˆæ¯é˜Ÿåˆ—é‡Œé¢å°±æœ‰åº”ç”¨ï¼Œ
ä½†æ˜¯å®ƒæ— æ³•ä¿è¯é€šçŸ¥é¡ºåºï¼Œæ˜¯éšæœºçš„ã€‚
</p>

### ğŸ€ä»£ç æ ·ä¾‹

<P style="text-indent:2em;">
é¦–å…ˆå®šä¹‰è§‚å¯Ÿè€…ï¼Œä»–éœ€è¦æ—¶åˆ»å‡†å¤‡æ›´æ–°ä¿¡æ¯ï¼Œç„¶åéœ€è¦æœ‰ä¸€ä¸ªä¸»é¢˜ç±»ï¼Œè¿™ä¸ªä¸»é¢˜è¦æ±‚æœ‰å¢åˆ è§‚å¯Ÿè€…(è®¢é˜…è€…)ï¼Œ
è¿˜æœ‰æé†’çš„åŠŸèƒ½ã€‚
</p>

=== "è§‚å¯Ÿè€…"

    ```java
    public abstract class Observer {
        protected Subject subject;
        public abstract void update(String message);
    }
    ```

=== "ä¸»é¢˜"

    ```java
    public class Subject {
        private final List<Observer> observers = Lists.newArrayList();

        public void registerObserver(Observer observer) {
            observers.add(observer);
        }

        public void removeObserver(Observer observer) {
            observers.remove(observer);
        }

        /**
         * é€šçŸ¥
         */
        public void notifyObservers(String message) {
            observers.forEach(observer -> observer.update(message));
        }
    }
    ```

<P style="text-indent:2em;">
è§‚å¯Ÿè€…æ¥å£åªæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ²¡æœ‰å…·ä½“å®ç°ï¼Œä¸ºæ­¤å¯ä»¥æ ¹æ®ä¸šåŠ¡å¢åŠ å­ç±»ã€‚
</p>

=== "ç –å¤´"

    ```java
    public class BrickObserver extends Observer {

        public BrickObserver(Subject subject) {
            this.subject = subject;
            this.subject.registerObserver(this);
        }

        @Override
        public void update(String message) {
            System.out.println("ç –å¤´è§‚å¯Ÿè€…æ¥æ”¶åˆ°äº†ä¿¡æ¯:" + message);
        }
    }
    ```

=== "æ··å‡åœŸ"

    ```java
    public class ConcreteObserver extends Observer {

        public ConcreteObserver(Subject subject) {
            this.subject = subject;
            this.subject.registerObserver(this);
        }

        @Override
        public void update(String message) {
            System.out.println("æ··å‡åœŸè§‚å¯Ÿè€…æ¥æ”¶åˆ°äº†ä¿¡æ¯:" + message);
        }
    }
    ```

=== "é’¢ç­‹"

    ```java
    public class RebarObserver extends Observer {

        public RebarObserver(Subject subject) {
            this.subject = subject;
            this.subject.registerObserver(this);
        }

        @Override
        public void update(String message) {
            System.out.println("é’¢ç­‹è§‚å¯Ÿè€…æ¥æ”¶åˆ°äº†ä¿¡æ¯:" + message);
        }
    }
    ```

### ğŸ”ä½¿ç”¨æ–¹å¼

<P style="text-indent:2em;">
ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦åœ¨æœ‰å„è‡ªå¯¹è±¡çš„æ—¶å€™ï¼Œç›´æ¥é€šçŸ¥å³å¯ã€‚
</p>

```java
public class TestObserver {
    public static void main(String[] args) {
        Subject subject = new Subject();
        new ConcreteObserver(subject);
        new RebarObserver(subject);
        new BrickObserver(subject);
        subject.notifyAllObservers("å¤§å®¶å‡†å¤‡å¼€å§‹é€ æˆ¿å­");
    }
}
```